# 代码展示模块 (Code Module)

### 1. 模块简介

代码展示模块是 Matcha.js 的"程序员专属神器"。它能让你的代码块不再只是单调的黑底白字，而是拥有专业 IDE 一样的视觉效果。

该模块的特色功能：

- **自适应布局**：自动适配所在的容器宽高。当放入多列布局时，它会自动收缩并启用滚动条，绝不溢出。
- **智能缩进**：自动去除由于 HTML 模板缩进产生的冗余前导空格，保持代码纯净。
- **语言标签**：在代码块右上角显示当前代码的语言类型，并根据语言自动配色。
- **行号显示**：可选地为代码添加行号，让讲解更加清晰。
- **高亮指定行**：突出显示重点代码行，引导观众视线。
- **一键复制**：鼠标悬停时出现复制按钮，方便观众直接拷贝代码。
- **macOS 风格**：标题栏带有精致的红绿灯按钮，科技感拉满。

---

### 2. 模块使用 demo

在代码块之前使用指令来增强它的显示效果：

```markdown
<!-- code: lang=javascript, lineNumbers=true, highlight=2-3, title=app.js -->

```javascript
const matcha = new Matcha();
matcha.start();
console.log('Hello, Matcha!');
```
```

在布局中使用（代码块将自动适配列宽和高度）：

```markdown
<!-- layout: cols -->
### 左侧说明
这里是关于代码的解释。

+++

<!-- code: title=Logic.js -->
```javascript
function demo() {
  // 这部分代码会自动出现滚动条
  // 而不是撑开整个页面
  return true;
}
```
```

---

### 3. 模块的语法

#### 基本语法

在代码块（\`\`\`）之前添加配置指令：

```markdown
<!-- code: 参数1=值1, 参数2=值2 -->
```

#### 属性介绍

| 属性名        | 说明                              | 默认值  | 示例                 |
| :------------ | :-------------------------------- | :------ | :------------------- |
| `lang`        | 语言名称（覆盖代码块标记）        | 自动    | `javascript`, `python` |
| `lineNumbers` | 是否显示行号                      | `false` | `true`, `false`      |
| `highlight`   | 高亮指定行（逗号分隔，支持范围）  | 无      | `2`, `1,3,5`, `2-5`  |
| `title`       | 代码块标题（如文件名）            | 无      | `index.js`, `示例代码` |
| `copy`        | 是否显示复制按钮                  | `true`  | `true`, `false`      |
| `maxHeight`   | 最大高度（超出滚动）              | 适配容器 | `300px`, `none`      |

---

### 4. 介绍模块的其他配置

- **全局默认值**：你可以在 `Matcha` 初始化时设置代码模块的全局默认行为：

```javascript
const app = new Matcha({
  code: {
    defaultLineNumbers: true, // 全局默认显示行号
    defaultCopy: true,        // 全局默认显示复制按钮
    highlightColor: 'rgba(255, 200, 0, 0.1)' // 自定义高亮行颜色
  }
});
```

- **智能缩进处理**：模块会自动检测并移除代码块中由于 HTML 格式化产生的公共前导空格，确保代码显示时保持原始的相对缩进。
- **布局适配细节**：代码块现在是真正的“自适应”组件。在 Flex 或 Grid 布局中，它会根据分配的空间自动调整大小。如果代码内容超过了分配的宽高，会自动出现横向或纵向滚动条。
- **高度控制**：
  - 默认情况下，代码块会尽量填满父容器的高度。
  - 你可以通过 `maxHeight=300px` 强制限制高度。
  - 使用 `maxHeight=none` 可以让代码块完全撑开，不受容器限制。
- **复制反馈**：点击复制按钮后会立即显示 "Copied!" 提示，2 秒后自动恢复原样。
